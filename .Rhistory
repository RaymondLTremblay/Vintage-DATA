tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_text(color = "darkgrey", weight = "bold"),
locations = cells_stub()
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.")
gt(BCT3) %>%
tab_header(title = md("Body length of tadpoles")) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_borders(sides = "right", color = "black",
style = "dashed", weight = px(3)),
locations = cells_body(
columns = vars(length_corpuscles)
)
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.")
gt(BCT3) %>%
tab_header(title = md("Body length of tadpoles")) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_borders(sides = "right", color = "black",
style = "dashed", weight = px(3)),
locations = cells_body(
columns = vars(length_corpuscles)
)
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.") %>%
data_color(
columns = vars=c(, 2:4),
gt(BCT3) %>%
tab_header(title = md("Body length of tadpoles")) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_borders(sides = "right", color = "black",
style = "dashed", weight = px(3)),
locations = cells_body(
columns = vars(length_corpuscles)
)
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.") %>%
data_color(
columns = vars(),
colors = scales::col_numeric(
colorspace::diverge_hcl(n = 9, palette = "Purple-Green") %>% rev(),
domain = range(nottem))
)
gt(BCT3) %>%
tab_header(title = md("Body length of tadpoles")) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_borders(sides = "right", color = "black",
style = "dashed", weight = px(3)),
locations = cells_body(
columns = vars(length_corpuscles)
)
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.") %>%
data_color(
columns = vars(5.35, 5.85),
colors = scales::col_numeric(
colorspace::diverge_hcl(n = 9, palette = "Purple-Green") %>% rev(),
domain = range(nottem))
)
gt(BCT3) %>%
tab_header(title = md("Body length of tadpoles")) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_borders(sides = "right", color = "black",
style = "dashed", weight = px(3)),
locations = cells_body(
columns = vars(length_corpuscles)
)
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.") %>%
data_color(
columns = vars(5.35, 5.85),
colors = scales::col_numeric(
palette = c(
"white", "orange", "red"),
domain = c(0, 10))
)
#BCT2a
BCT3<-BCT2a %>%
select(1,10:19, 2:9)
BCT3
BCT3$length_corpuscles = as.factor(BCT3$length_corpuscles)
gt(BCT3) %>%
tab_header(title = md("Body length of tadpoles")) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_borders(sides = "right", color = "black",
style = "dashed", weight = px(3)),
locations = cells_body(
columns = vars(length_corpuscles)
)
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.") %>%
data_color(
columns = vars(5.35, 5.85),
colors = scales::col_numeric(
palette = c(
"white", "orange", "red"),
domain = c(0, 10))
)
gt(BCT3) %>%
tab_header(title = md("Body length of tadpoles")) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_borders(sides = "right", color = "black",
style = "dashed", weight = px(3)),
locations = cells_body(
columns = vars(length_corpuscles)
)
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.")
gt(BCT3) %>%
tab_header(title = md("Body length of tadpoles")) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_borders(sides = "right", color = "black",
style = "dashed", weight = px(3)),
locations = cells_body(
columns = vars(length_corpuscles)
)
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.") %>%
data_color(
columns = vars("5.35", "5.85"),
colors = scales::col_numeric(
palette = c(
"white", "orange", "red"),
domain = c(0, 10))
)
gt(BCT3) %>%
tab_header(title = md("Body length of tadpoles")) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_borders(sides = "right", color = "black",
style = "dashed", weight = px(3)),
locations = cells_body(
columns = vars(length_corpuscles)
)
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.") %>%
data_color(
columns = vars("5.35", "5.85", "6.35",	"6.85",	"7.35",	"7.85",	"8.35",
"8.85",	"9.35",	"9.85",	"10.35",	"10.85",	"11.35",	"11.85",	"12.35",	"13.35",	"13.84",	"13.85"),
colors = scales::col_numeric(
palette = c(
"white", "orange", "red"),
domain = c(0, 30))
)
BCT
BCT2
BCT2 %>%
summarize(meanBL=mean(body_lenght))
BCT2 %>%
summarize(meanBL=mean(body_lenght
SD=sd(body_lenght)))
BCT2 %>%
summarize(meanBL=mean(body_lenght),
SD=sd(body_lenght)))
BCT2 %>%
summarize(meanBL=mean(body_lenght),
SD=sd(body_lenght))
BCT2
BCT2 %>%
summarize(meanBL=mean(length_corpuscles),
SD=sd(length_corpuscles))
BCT2
BCT2 %>%
summarize(meanBC=mean(length_corpuscles),
SD-BL=sd(length_corpuscles))
BCT2 %>%
summarize(meanBC=mean(length_corpuscles),
SD-BL=sd(length_corpuscles))
BCT2 %>%
summarize(meanBC=mean(length_corpuscles),
SDBL=sd(length_corpuscles))
BCT2 %>%
summarize(mean_BC=mean(length_corpuscles),
SD_BL=sd(length_corpuscles))
ggplot(BCT2, aes(body_length, length_corpuscles))+
geom_point
ggplot(BCT2, aes(body_length, length_corpuscles))+
geom_point()
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_point()
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_point()+
geom_smoot(method=lm)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_point()+
geom_smooth(method=lm)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_point()+
geom_smooth(method=lm)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_jitter()+
geom_smooth(method=lm)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_point(aes(colour = cut(qsec, c(-Inf, 17, 19, Inf))),
size = 5) +
scale_color_manual(name = "qsec",
values = c("(-Inf,17]" = "black",
"(17,19]" = "yellow",
"(19, Inf]" = "red"),
labels = c("<= 17", "17 < qsec <= 19", "> 19"))+
geom_smooth(method=lm)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_point()+
geom_smooth(method=lm)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count()+
geom_smooth(method=lm)
ggplot(BCT2, aes(body_lenght, length_corpuscles, fill=freq))+
geom_count()+
geom_smooth(method=lm)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count()+
geom_smooth(method=lm)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth(method=lm)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth(method=lm)+
guides(color = 'legend')
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth(method=lm)+
guides(color = 'legend')+
guides(size="none")
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth(method=lm)+
guides(color = 'legend')+
guides(size="none")+
scale_fill_gradient(low = "white", high = "orange", na.value = NA)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth(method=lm)+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "white", high = "orange", na.value = NA)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth(method=lm)+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)
model=lm(length_corpuscles~body_lenght, data=BCT2)
summary(model)
cor(length_corpuscles~body_lenght, data=BCT2)
cor(BCT2$length_corpuscles, BCT2$body_lenght)
knitr::opts_chunk$set(echo = TRUE)
head(BCT, n=5)
library(tidyverse)
library(janitor)
library(reshape)# "untable"
library(gt)
library(readxl)
Table_A_lenCorpuscles_Bodylen <- read_excel("DATA/Red_blood_cells/Table_A_lenCorpuscles_Bodylen.xlsx")
gt(head(Table_A_lenCorpuscles_Bodylen, n=3))
#length(Table_A_lenCorpuscles_Bodylen$Num_individuals)
#sum(Table_A_lenCorpuscles_Bodylen$Num_individuals)
BCT=as.data.frame(Table_A_lenCorpuscles_Bodylen) # VERY IMPORTANT STEP, convert to a data frame
#BCT$length_corpuscles=as.character(BCT$length_corpuscles)
#BCT$body_lenght=as.character(BCT$body_lenght)
head(BCT, n=5)
BCT(10:14,)
head(BCT, n=5)
BCT(10:14,)
BCT[10:14,]
untable(BCT[10:14,])
untable(BCT[10:14,c(1,2)], num =BCT[,3])
BCT2=untable(BCT[,c(1,2)], num =BCT[,3])
#BCT2
untable(BCT[ c(11:14),c(1,2)], num =BCT[,3])
untable(BCT[c(11:14),c(1,2)], num =BCT[,4])
head(BCT, n=5)
BCT[10:14,]
untable(BCT[c(11:14),c(1,2)], num =BCT[,"Num_individuals"])
untable(BCT[,c(1,2)], num =BCT[,"Num_individuals"])
untable(BCT[c(11,12),c(1,2)], num =BCT[,"Num_individuals"])
untable(BCT[,c(1,2)], num =BCT[,"Num_individuals"])
BCT[10:14,]
BCT2=untable(BCT[,c(1,2)], num =BCT[,3])
#BCT2
BCT2a=BCT2 %>%
tabyl(length_corpuscles, body_lenght)
#BCT2a
BCT3<-BCT2a %>%
select(1,10:19, 2:9)
BCT3$length_corpuscles = as.factor(BCT3$length_corpuscles)
gt(BCT3) %>%
tab_header(title = md("Body length of tadpoles")) %>%
tab_style(
locations = cells_column_labels(columns = everything()),
style     = list(
#Give a thick border below
cell_borders(sides = "bottom", weight = px(3)),
#Make text bold
cell_text(weight = "bold")
)
) %>%
tab_style(
style = cell_borders(sides = "right", color = "black",
style = "dashed", weight = px(3)),
locations = cells_body(
columns = c(length_corpuscles)
)
) %>%
tab_source_note(source_note = "Pearson, K. (1909). A Biometric Study of the Red Blood Corpuscles of the Common Tadpole (Rana Temporaria), from the Measurements of Ernest Warren. Biometrika, 402-419.") %>%
data_color(
columns = c("5.35", "5.85", "6.35",	"6.85",	"7.35",	"7.85",	"8.35",
"8.85",	"9.35",	"9.85",	"10.35",	"10.85",	"11.35",	"11.85",	"12.35",	"13.35",	"13.84",	"13.85"),
colors = scales::col_numeric(
palette = c("white", "orange", "brown"),
domain = c(0, 30))
)
#BCT2
## Mean and standar deviation of body length
BCT2 %>%
summarize(meanBL=mean(body_lenght),
SD=sd(body_lenght))
## Mean and standar deviation of length of corpuscules
BCT2 %>%
summarize(mean_BC=mean(length_corpuscles),
SD_BL=sd(length_corpuscles))
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth(method=lm)+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth(method=lm)+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth()+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth()+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)+
ylim(7.0, 8.4)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth()+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)+
ylim(7.0, 8.4)+
xlim(5.85, 14.85)
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth()+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)+
coord_cartesian(ylim= c(7.0, 8.4), xlim=c(5.85, 14.85))
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth()+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)+
coord_cartesian(ylim= c(7.0, 8.4), xlim=c(5.85, 14.85))+
scale_x_continuous(breaks=seq(5.85, 14.85, len=1))
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth()+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)+
coord_cartesian(ylim= c(7.0, 8.4), xlim=c(5.85, 14.85))+
scale_x_continuous(breaks=seq(5.85, 14.85, len=10))
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth()+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)+
coord_cartesian(ylim= c(7.0, 8.4), xlim=c(5.85, 14.85))+
scale_x_continuous(breaks=seq(4.85, 14.85, len=11))
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth()+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)+
coord_cartesian(ylim= c(7.0, 8.4), xlim=c(5.85, 14.85))+
scale_x_continuous(breaks=seq(4.85, 14.85, len=11))+
xlab("Body length of tadpole")+
ylab("Length of blood corpuscules")
ggplot(BCT2, aes(body_lenght, length_corpuscles))+
geom_count(aes(color=..n..))+
geom_smooth(method=lm)+
guides(color = 'legend')+
guides(size="none")+
scale_colour_gradient(low = "grey", high = "orange", na.value = NA)+
coord_cartesian(ylim= c(7.0, 8.4), xlim=c(5.85, 14.85))+
scale_x_continuous(breaks=seq(4.85, 14.85, len=11))+
xlab("Body length of tadpole")+
ylab("Length of blood corpuscules")
summary(model)
model=lm(length_corpuscles~body_lenght, data=BCT2)
summary(model)
cor(BCT2$length_corpuscles, BCT2$body_lenght)
cor(BCT2$length_corpuscles, BCT2$body_lenght)
library(tidyverse)
library(janitor)
library(reshape) # for the "untable" function
library(gt)
library(readxl)
Table_A_lenCorpuscles_Bodylen <- read_excel("DATA/Red_blood_cells/Table_A_lenCorpuscles_Bodylen.xlsx")
gt(head(Table_A_lenCorpuscles_Bodylen, n=3))
#length(Table_A_lenCorpuscles_Bodylen$Num_individuals)
#sum(Table_A_lenCorpuscles_Bodylen$Num_individuals)
BCT=as.data.frame(Table_A_lenCorpuscles_Bodylen) # VERY IMPORTANT STEP, convert to a data frame
#BCT$length_corpuscles=as.character(BCT$length_corpuscles)
#BCT$body_lenght=as.character(BCT$body_lenght)
