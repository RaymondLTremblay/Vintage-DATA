knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(gt)
library(reshape)
library(janitor)
view(T2i)
library(tidyverse)
library(ggplot2)
library(gt)
library(reshape)
library(janitor)
df=as.data.frame(T2i)%>%
mutate(survivors = Count_Total_Birth - Count_Non_survivors)
T2i <- read_csv("csv_files/T2i.csv")
df=as.data.frame(T2i)%>%
mutate(survivors = Count_Total_Birth - Count_Non_survivors)
df1<- untable(df[,c(1,2,4,5)], num = df[,3])%>%
filter(Count_Non_survivors > 0)%>%
mutate(dead = ifelse(Count_Non_survivors>=0,0))
df2<- untable(df[,c(1,2,5,4)], num = df[,2])%>%
filter(survivors >0)%>%
mutate(Survivors = ifelse(survivors >0, 1))
df3 <- merge(df1, df2)
df=as.data.frame(T2i)%>%
mutate(survivors = Count_Total_Birth - Count_Non_survivors)
df1<- untable(df[,c(1,2,4,5)], num = df[,3])%>%
filter(Count_Non_survivors > 0)%>%
mutate(dead = ifelse(Count_Non_survivors>=0,0))
df2<- untable(df[,c(1,2,5,4)], num = df[,2])%>%
filter(survivors >0)%>%
mutate(Survivors = ifelse(survivors >0, 1))
df3 <- merge(df1, df2)
head(df3)
head(df3)
df3%>%
ggplot()+
geom_point(aes(Mother_age, Count_Non_survivors))+
geom_smooth(aes(Mother_age, Count_Non_survivors))
df3%>%
ggplot()+
geom_histogram(aes(Count_Non_survivors))+
geom_smooth(aes(Mother_age, Count_Non_survivors))
df3%>%
ggplot()+
geom_histogram(aes(Count_Non_survivors))
df3%>%
ggplot()+
geom_histogram(aes(Count_Non_survivors))+
geom_histogram(aes(survivors))
df3%>%
ggplot()+
geom_histogram(aes(Count_Non_survivors))+
geom_histogram(aes(survivors), colour= "green")
df3%>%
ggplot()+
geom_histogram(aes(survivors), fill= "green", colour="black")
gt(gt2)
gt2<-head(df3)
gt(gt2)
summary(Mother_age ~ Count_Non_survivors)
regr1 <- lm(Mother_age ~ survivors, data = T2i)
regr1 <- lm(Mother_age ~ survivors, data = df3)
coefficients(regr1)
summary(regr1)
df3%>%
ggplot()+
geom_histogram(aes(survivors), fill= "green", colour="black")
##Utilizar normalized linear model y family = binomial
Gompertz <- function(x, y0, ymax, k, lag){
result <- y0 + (ymax -y0)*exp(-exp(k*(lag-x)/(ymax-y0) + 1) )
return(result)
}
regr1 <- gml(Mother_age ~ survivors, data = df3, family = binomial)
library(dyplr)
library(dplyr)
##Utilizar normalized linear model y family = binomial
regr1 <- gml(Mother_age ~ survivors, data = df3, family = binomial)
?gml
##Utilizar normalized linear model y family = binomial
regr1 <- glm(Mother_age ~ survivors, data = df3, family = binomial)
regr1 <- glm(Mother_age ~ Count_Non_survivors, data = df3, family = binomial)
head(df3)
##Utilizar normalized linear model y family = binomial
regr1 <- glm(Mother_age ~ dead, data = df3, family = binomial)
regr1 <- glm(Mother_age ~ Count_Non_survivors, data = df3, family = binomial)
