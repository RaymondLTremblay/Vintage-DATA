---
title: "Karn_Penrose"
author: "Axel Leon"
date: "3/8/2022"
output: html_document
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE}
Sys.Date()
```

### Birth Weight and gestation time in relation to maternal age, parity and infant survival

------------------------------------------------------------------------

A study between the relation in mother's age, parity and how this affects infant survival

-   Authors:Mary N. Karn and L.S. Penrose
-   KARN, M. N., & PENROSE, L. S. (1951). Birth weight and gestation time in relation to maternal age, parity and infant survival. Annals of eugenics, 16(2), 147--164.

------------------------------------------------------------------------

> ### Brief introduction by the authors
>
> The present communication continues a statistical analysis (Karn, Lang-Brown. MacKenzie & Penrose , 1951; Karn, 1947) of the relation between birth weight and gestation time, taking into account the mother's age and parity.
>
> The large body of data assembled from the records of U.C.H. Obstetric Hospital for the years 1935-46 contains information about 13, 730 infants (7037 male, 6693 female) and their mothers.

You can download this paper on the following [here](https://doi.org/10.1111/j.1469-1809.1951.tb02469.x)

------------------------------------------------------------------------

### Abstract from the paper

> The articles published by the Annals of Eugenics (1925--1954) have been made available online as an historical archive intended for scholarly use. The work of eugenicists was often pervaded by prejudice against racial, ethnic and disabled groups. The online publication of this material for scholarly research purposes is not an endorsement of those views nor a promotion of eugenics in any way.

[@karn1951]

------------------------------------------------------------------------

Here we can have a look at the data from the appendix

![](images/Screen%20Shot%202022-03-09%20at%209.33.04%20AM.png){width="619"}

[@karn1951]

------------------------------------------------------------------------

### Objective {style="color: black"}

This Rmd is to learn how to format the data prior to analyses. The data are collected form the Karn and Penrose, in the same structure they present in the paper, for analysis they needed to be wrangled for effective analysis in R and RStudio.

```{r message=FALSE, warning=FALSE, include=FALSE}
library(tidyverse)
library(ggplot2)
library(gt)
library(reshape)
library(janitor)
library(caret)
library(gridExtra)
library(cowplot)
```

------------------------------------------------------------------------

```{r warning=FALSE, include=FALSE}
T2i <- read_csv("csv_files/T2i.csv")
T2ii<- read_csv("csv_files/Mother_age_BW_Females_T2ii.csv")
```

------------------------------------------------------------------------

### Using untable function with our data set from the paper

Create a data frame for all death **0** and surviving babies **1**.

-   Calculate the number of survivors

-   Assign to a new column the code of **0** for all dead babies

-   Assign to a new column the code of **0** for all babies alive

-   Untable (expand) the data set the number of times each conditions are present like the mother's age and the baby's birth weight.

-   bind both data frames in one

-   arrange (sort) by age of mother or weight (your preference)

```{r include=FALSE}
df=as.data.frame(T2i) %>%
  mutate(survivors = total_birth - non_survivors)

## untable non-survivors
df1<- untable(df[,c(1,2,4,5)], num = df[,"non_survivors"])%>%
  filter(non_survivors >0)%>%
  mutate(Alive_Dead = ifelse(non_survivors >0,0, NA))
df1

```

```{r}
## untable survivors
df2<- untable(df[,c(1,2,5,4)], num = df[,"survivors"]) %>%
  filter(survivors >0) %>%
  mutate(Alive_Dead = ifelse(survivors >0, 1, NA))
df2
```



```{r}
df5=bind_rows(df1, df2)%>%
    mutate(sex = "male")# Function in dplyr
df5 %>% arrange(mother_age)
row.names(df5)<-NULL  # this removes the row names
df5 %>% arrange(mother_age)

```






```{r}
af=as.data.frame(T2ii)%>%
  mutate(survivors = total_birth - non_survivors)
head(af)


## untable non-survivors
af1<- untable(af[,c(1,3,4,5)], num = af[,2]) %>%
  filter(non_survivors >0) %>%
  mutate(Alive_Dead = ifelse(non_survivors > 0,0, NA))

af1

```

```{r}
## untable survivors
af2<- untable(af[,c(1,2,5,4)], num = af[,"survivors"])%>%
  filter(survivors >0)%>%
  mutate(Alive_Dead = ifelse(survivors >0, 1, NA))
af2
```

```{r}
af5=bind_rows(af1, af2)%>%
  mutate(sex = "female")# Function in dplyr
af5 %>% arrange(mother_age)
row.names(af5)<-NULL  # this removes the row names
af5 %>% arrange(mother_age)
qf=bind_rows(af5, df5)
qf %>% arrange(birth_weight)
row.names(qf)<-NULL
qf
```

Data before de "untable" function

```{r echo=FALSE}
gt(head(df, n=5))
```

Data after the "untable" function.

```{r echo=FALSE}
gt(head(df5, n=5))
```

We can see in the table below that two columns where added. One called "Alive_Dead" where the **0** represents that the infant died and the **1** represents that the infant died. The other column added in both data sets where we identified the biological sex of the infant. The exact same codes are used in order do wrangle de data containing the information on females infants.

Using the following equation *[survivors/total births] \*100* we were able to obtain the percentage of survival on infants has depending its birth weight and the mother's age.

